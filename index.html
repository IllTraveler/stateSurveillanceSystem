<!DOCTYPE html> 
<html>
<head>
    <title>Report Of Ill Traveler</title>
    <script>
        function outputTravelerJson() {
            var firstName = document.getElementById('firstName').value;
            var lastName = document.getElementById('lastName').value;
            var dob = document.getElementById('dob').value;
            var sex = document.getElementById('sex').value;
            var email = document.getElementById('email').value;
            var phone = document.getElementById('phone').value;
            var data = {
                "resourceType" : "Patient",
                "id" : "travelerExample",
                "meta" : {
                    "profile" : [
                    "http://hl7.org/fhir/us/reportofilltraveler/StructureDefinition/Traveler"
                    ]
                },
                  "name" : [
                        {
                        "family" : lastName,
                        "given" : [
                        firstName
                        ]
                        }
                    ],
                "birthdate": dob,
                "gender": sex,
                "telecom" : [
                        {
                        "system" : "phone",
                        "value" : phone,
                        "use" : "home"
                        },
                        {
                        "system" : "email",
                        "value" : email
                        }
                    ]
            };
            document.getElementById('Traveleroutput').innerHTML = JSON.stringify(data, null, 2);
            sendToCDC();
            return false;
        }
        function sendToCDC(){
            var firstName = document.getElementById('firstName').value;
            var lastName = document.getElementById('lastName').value;
            var dob = document.getElementById('dob').value;
            var sex = document.getElementById('sex').value;
            var email = document.getElementById('email').value;
            var phone = document.getElementById('phone').value;
            var data = {
                "resourceType" : "Patient",
                "id" : "travelerExample",
                "meta" : {
                    "profile" : [
                    "http://hl7.org/fhir/us/reportofilltraveler/StructureDefinition/Traveler"
                    ]
                },
                  "name" : [
                        {
                        "family" : lastName,
                        "given" : [
                        firstName
                        ]
                        }
                    ],
                "birthdate": dob,
                "gender": sex,
                "telecom" : [
                        {
                        "system" : "phone",
                        "value" : phone,
                        "use" : "home"
                        },
                        {
                        "system" : "email",
                        "value" : email
                        }
                    ],
                };
            fetch("https://api.logicahealth.org/AirCI/open/Patient", {
                method: "POST",
                body: JSON.stringify(data, null, 2),
                headers: {
                    "Content-type": "application/json; charset=UTF-8"
                }
            })
            .then((response) => response.json())
            .then((json) => console.log(json));
        }
    </script>
</head>
 <body> 
    <h2>Report Of Ill Traveler</h2> 
    <form onsubmit="return outputTravelerJson()" id="jsonForm"> 
        <section>
            <h2>Traveler Info</h2>
        Name: <input type="text" id="name">
        Email: <input type="text" id="email">
        First name:<br>  <input type="text" id="firstName"><br> 
        Last name:<br>  <input type="text" id="lastName"><br><br> 
        Date of Birth: <br>  <input type="date" id="dob" name="Date of Birth"  />
        Gender: <br> 
        <select name="sex" id="sex">
            <option value="male">Male</option>
            <option value="female">Female</option>
            <option value="other">Other</option>
            <option value="unknown">Unknown</option>
        </select><br>
        Phone Number:<br>  <input type="text" id="phone"><br><br> 
    </section>
    <input type="submit" value="Submit">
</form>
    <p id="result">     </p> 
    <pre id="Traveleroutput"></pre>
    
        <a href="Report.html">Proceed to Report</a>
    <p id="result">     </p> 
    <pre id="Reportoutput"></pre>

    </body> 
</html>